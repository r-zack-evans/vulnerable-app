import{_ as D,A as w,B as P,a as T,c as C,w as u,j as _,r as k,o as r,b as s,t as a,i as n,f as d,k as g,l as v,h as f,d as S,n as p}from"./main-BpEgt2VT.js";const B={name:"DashboardView",components:{BaseLayout:T,Button:P,AlertMessage:w},data(){return{loading:{projects:!0,tasks:!0},error:null,user:null,projects:[],tasks:[],projectStats:{total:0,active:0,completed:0},taskStats:{total:0,completed:0,overdue:0}}},computed:{recentProjects(){return this.projects.slice(0,5)},myTasks(){return this.user?this.tasks.filter(o=>o.assignedTo===this.user.id):[]},upcomingTasks(){const o=new Date,t=new Date;return t.setDate(t.getDate()+7),this.myTasks.filter(i=>{if(!i.dueDate)return!1;const h=new Date(i.dueDate);return h>=o&&h<=t&&i.status!=="Complete"}).slice(0,5)},inProgressTasks(){return this.myTasks.filter(o=>o.status==="In Progress").slice(0,5)}},methods:{async fetchUser(){try{const o=await _.get("/users/profile");this.user=o.data.user}catch(o){console.error("Error fetching user:",o)}},async fetchProjects(){this.loading.projects=!0;try{const o=await _.get("/projects");this.projects=o.data,this.projectStats.total=this.projects.length,this.projectStats.active=this.projects.filter(t=>t.status==="In Progress").length,this.projectStats.completed=this.projects.filter(t=>t.status==="Complete").length}catch(o){console.error("Error fetching projects:",o)}finally{this.loading.projects=!1}},async fetchTasks(){this.loading.tasks=!0;try{const o=await _.get("/tasks");this.tasks=o.data,this.taskStats.total=this.tasks.length,this.taskStats.completed=this.tasks.filter(i=>i.isCompleted).length;const t=new Date;this.taskStats.overdue=this.tasks.filter(i=>!i.dueDate||i.isCompleted?!1:new Date(i.dueDate)<t).length}catch(o){console.error("Error fetching tasks:",o)}finally{this.loading.tasks=!1}},getProjectName(o){const t=this.projects.find(i=>i.id===o);return t?t.name:"Unknown Project"},formatDate(o){return o?new Date(o).toLocaleDateString():""}},created(){this.fetchUser(),this.fetchProjects(),this.fetchTasks()}},L={class:"dashboard"},N={class:"stats-cards"},V={class:"stats-card"},b={class:"card-content"},x={class:"stats-card"},I={class:"card-content"},A={class:"stats-card"},E={class:"card-content"},U={class:"stats-card"},F={class:"card-content"},M={class:"dashboard-content"},z={class:"recent-projects"},R={class:"section-header"},W={key:0,class:"loading"},q={key:1,class:"no-data"},G={key:2,class:"projects-list"},H={class:"project-info"},J={class:"project-meta"},K={key:0,class:"due-date"},O={class:"project-progress"},Q=["data-progress"],X={class:"tasks-summary"},Y={class:"section-header"},Z={key:0,class:"loading"},$={key:1,class:"no-data"},ss={key:2,class:"tasks-sections"},ts={class:"task-section"},es={class:"task-list"},os={class:"task-details"},as={class:"task-meta"},rs={class:"task-section"},ns={class:"task-list"},is={class:"task-details"},ls={class:"task-meta"};function cs(o,t,i,h,c,l){const j=k("Button"),m=k("router-link"),y=k("BaseLayout");return r(),C(y,null,{default:u(()=>[s("div",L,[t[15]||(t[15]=s("h1",null,"Project Dashboard",-1)),s("div",N,[s("div",V,[t[3]||(t[3]=s("div",{class:"card-icon"},[s("span",{class:"material-icons"},"assignment")],-1)),s("div",b,[s("h3",null,a(c.projectStats.total),1),t[2]||(t[2]=s("p",null,"Total Projects",-1))])]),s("div",x,[t[5]||(t[5]=s("div",{class:"card-icon"},[s("span",{class:"material-icons"},"pending_actions")],-1)),s("div",I,[s("h3",null,a(c.projectStats.active),1),t[4]||(t[4]=s("p",null,"Active Projects",-1))])]),s("div",A,[t[7]||(t[7]=s("div",{class:"card-icon"},[s("span",{class:"material-icons"},"task_alt")],-1)),s("div",E,[s("h3",null,a(c.projectStats.completed),1),t[6]||(t[6]=s("p",null,"Completed Projects",-1))])]),s("div",U,[t[9]||(t[9]=s("div",{class:"card-icon"},[s("span",{class:"material-icons"},"task")],-1)),s("div",F,[s("h3",null,a(c.taskStats.total),1),t[8]||(t[8]=s("p",null,"Total Tasks",-1))])])]),s("div",M,[s("div",z,[s("div",R,[t[10]||(t[10]=s("h2",null,"Recent Projects",-1)),d(j,{onClick:t[0]||(t[0]=e=>o.$router.push("/projects")),variant:"outline",text:"View All"})]),c.loading.projects?(r(),n("div",W,"Loading projects...")):l.recentProjects.length===0?(r(),n("div",q,"No projects found")):(r(),n("div",G,[(r(!0),n(g,null,v(l.recentProjects,e=>(r(),n("div",{key:e.id,class:"project-item"},[s("div",H,[s("h3",null,[d(m,{to:`/projects/${e.id}`},{default:u(()=>[f(a(e.name),1)]),_:2},1032,["to"])]),s("div",J,[s("span",{class:p(["status",e.status.toLowerCase().replace(" ","-")])},a(e.status),3),e.endDate?(r(),n("span",K,"Due: "+a(l.formatDate(e.endDate)),1)):S("",!0)])]),s("div",O,[s("div",{class:"progress-circle","data-progress":e.completionPercentage||0},a(e.completionPercentage||0)+"% ",9,Q)])]))),128))]))]),s("div",X,[s("div",Y,[t[11]||(t[11]=s("h2",null,"My Tasks",-1)),d(j,{onClick:t[1]||(t[1]=e=>o.$router.push("/tasks")),variant:"outline",text:"View All"})]),c.loading.tasks?(r(),n("div",Z,"Loading tasks...")):l.myTasks.length===0?(r(),n("div",$,"No tasks assigned to you")):(r(),n("div",ss,[s("div",ts,[t[12]||(t[12]=s("h3",null,"Due Soon",-1)),s("ul",es,[(r(!0),n(g,null,v(l.upcomingTasks,e=>(r(),n("li",{key:e.id,class:"task-item"},[s("span",{class:p(["status-dot","status-"+e.status.toLowerCase().replace(" ","-")])},null,2),s("div",os,[d(m,{to:`/tasks/${e.id}`},{default:u(()=>[f(a(e.title),1)]),_:2},1032,["to"]),s("span",as,a(l.getProjectName(e.projectId))+" â€¢ Due: "+a(l.formatDate(e.dueDate)),1)]),s("span",{class:p(["priority","priority-"+(e.priority||"medium").toLowerCase()])},a(e.priority),3)]))),128))])]),s("div",rs,[t[14]||(t[14]=s("h3",null,"In Progress",-1)),s("ul",ns,[(r(!0),n(g,null,v(l.inProgressTasks,e=>(r(),n("li",{key:e.id,class:"task-item"},[t[13]||(t[13]=s("span",{class:"status-dot status-in-progress"},null,-1)),s("div",is,[d(m,{to:`/tasks/${e.id}`},{default:u(()=>[f(a(e.title),1)]),_:2},1032,["to"]),s("span",ls,a(l.getProjectName(e.projectId)),1)]),s("span",{class:p(["priority","priority-"+(e.priority||"medium").toLowerCase()])},a(e.priority),3)]))),128))])])]))])])])]),_:1})}const us=D(B,[["render",cs],["__scopeId","data-v-145de8c4"]]);export{us as default};
